pipeline {
    agent { label 'master' }
    stages {
        stage('Preload') {
            steps {
                script {
                    COMMIT_HASH = sh (
                    script: '''#!/bin/bash
                    git show | grep -i -m 1 commit | awk '{print $2}' 
                    ''',
                    returnStdout: true).trim()
                    if (${env.CHANGE_BRANCH} == null) {
                    BRANCH_NAME = ${env.BRANCH_NAME}
                    }
                    else {
                    BRANCH_NAME = ${env.CHANGE_BRANCH}
                    }
                }
                echo "Branch name(env): ${env.BRANCH_NAME}"
                echo "Change branch(env): ${env.CHANGE_BRANCH}"
                echo "Change ID: ${env.CHANGE_ID}"
                echo "Branch name: ${BRANCH_NAME}"
                echo "Commit hash: ${COMMIT_HASH}"
            }
        }
        
        stage('Pre-Deployment') {
            steps {
                echo "This is the Pre-Deployment Stage"
            }
        }
        
        stage('Deployment') {
            steps {
                echo "This is the Deployment Stage"
            }
        }
        
        stage('Configuration') {
            steps {
                echo "This is the Configuration Stage"
            }
        }
        
        stage('Post-Deployment') {
            steps {
                echo "This is the Pre-Deployment Stage"
            }
        }
    }
}
